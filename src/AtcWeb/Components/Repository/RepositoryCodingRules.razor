@using AtcWeb.Domain.GitHub.Models
@using AtcWeb.State

@if (StateContainer is not null &&
     Repository is not null)
{
    <MudSimpleTable Bordered="true"
                    Elevation="0">
        <thead>
            <tr>
                <th style="width: 25%">Config level</th>
                <th>&nbsp;</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td style="vertical-align: top;">
                    Root
                </td>
                <td>
                    @if (Repository.CodingRules.HasRoot)
                    {
                        if (Repository.CodingRules.IsLatestVersionRoot)
                        {
                            <MudText Typo="Typo.body2"
                                     Class="my-0"
                                     Color="Color.Success">
                                .editorconfig is up to date
                            </MudText>
                        }
                        else
                        {
                            <MudTooltip Text="@($"Current version is '{Repository.CodingRules.GetCurrentVersionRoot()}' and latest version is '{CodingRulesMetadata.LatestVersionRoot}'")">
                                <MudText Typo="Typo.body2"
                                         Class="my-0"
                                         Color="Color.Warning">
                                    .editorconfig is not up to date
                                </MudText>
                            </MudTooltip>
                        }

                        <RepositoryCodingRulesLocalSuppressRules LocalSuppressRules="@Repository.CodingRules.GetLocalSuppressRulesRoot()" />
                    }
                    else
                    {
                        <MudText Typo="Typo.body2"
                                 Class="my-0"
                                 Color="Color.Warning">
                            .editorconfig is missing
                        </MudText>
                    }
                </td>
            </tr>

            <tr>
                <td style="vertical-align: top;">
                    Src
                </td>
                <td>
                    @if (Repository.CodingRules.HasSrc)
                    {
                        if (Repository.CodingRules.IsLatestVersionSrc)
                        {
                            <MudText Typo="Typo.body2"
                                     Class="my-0"
                                     Color="Color.Success">
                                .editorconfig is up to date
                            </MudText>
                        }
                        else
                        {
                            <MudTooltip Text="@($"Current version is '{Repository.CodingRules.GetCurrentVersionSrc()}' and latest version is '{CodingRulesMetadata.LatestVersionSrc}'")">
                                <MudText Typo="Typo.body2"
                                         Class="my-0"
                                         Color="Color.Warning">
                                    .editorconfig is not up to date
                                </MudText>
                            </MudTooltip>
                        }

                        <RepositoryCodingRulesLocalSuppressRules LocalSuppressRules="@Repository.CodingRules.GetLocalSuppressRulesSrc()" />
                    }
                    else
                    {
                        <MudText Typo="Typo.body2"
                                 Class="my-0"
                                 Color="Color.Warning">
                            .editorconfig is missing
                        </MudText>
                    }
                </td>
            </tr>

            <tr>
                <td style="vertical-align: top;">
                    Test
                </td>
                <td>
                    @if (Repository.CodingRules.HasTest)
                    {
                        if (Repository.CodingRules.IsLatestVersionTest)
                        {
                            <MudText Typo="Typo.body2"
                                     Class="my-0"
                                     Color="Color.Success">
                                .editorconfig is up to date
                            </MudText>
                        }
                        else
                        {
                            <MudTooltip Text="@($"Current version is '{Repository.CodingRules.GetCurrentVersionTest()}' and latest version is '{CodingRulesMetadata.LatestVersionTest}'")">
                                <MudText Typo="Typo.body2"
                                         Class="my-0"
                                         Color="Color.Warning">
                                    .editorconfig is not up to date
                                </MudText>
                            </MudTooltip>
                        }

                        <RepositoryCodingRulesLocalSuppressRules LocalSuppressRules="@Repository.CodingRules.GetLocalSuppressRulesTest()" />
                    }
                    else
                    {
                        <MudText Typo="Typo.body2"
                                 Class="my-0"
                                 Color="Color.Warning">
                            .editorconfig is missing
                        </MudText>
                    }
                </td>
            </tr>
        </tbody>
    </MudSimpleTable>
}

@code {

    [Inject]
    private StateContainer? StateContainer { get; set; }

    [Parameter]
    public AtcRepository? Repository { get; set; }

}